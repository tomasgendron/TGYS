 if ((Get-PSSnapin | Where-Object {$_.Name -eq 'Microsoft.SharePoint.Powershell'})-eq $null) 
    {
    	Add-PSSnapin "Microsoft.SharePoint.Powershell"
    }
# Varaibles definitions

$sourceSiteCollection = "https://go.conaresources.com"
$sourceAssetLibraryTitle = "Site Assets"
$targetSiteCollection = "https://go.conaresources.com/teams/Projects"
$targetAssetLibraryTitle = "Site Assets"

# Get Site Collections here
$sourceWeb = Get-SPWeb $sourceSiteCollection
# Get list objects here
$sourceList = $sourceWeb.Lists | ? {$_.Title -eq $sourceAssetLibraryTitle}
# Get Site Collections here
$destinationWeb = Get-SPWeb $targetSiteCollection
# Get list objects here
$destinationList = $destinationWeb.Lists | ? {$_.title -like $targetAssetLibraryTitle}
$allFolders = $sourceList.Folders
$rootFolder = $sourceList.rootFolder
$rootItems = $rootFolder.files
#Loop
foreach($rootItem in $rootItems)
{
    $sourceStream = $rootItem.OpenBinary()
    $destinationFileItem = $destinationList.rootFolder.Files.Add($rootItem.Name, $sourceStream, $true)
    $destinationFileItem.Update()
}

#Loop for rest of the folders

foreach($folder in $allFolders)
{
    Remove-Variable ParentFolderURL
    $cnt = 0
    $folderURL = $folder.url.Split("/")
    while($cnt -lt ($folderURL.count-1))
    {
    $ParentFolderURL = "$ParentFolderURL/" + $folderURL[$cnt]
    $cnt++
    }
    
    $currFolder = $destinationList.Folders | ? {$_.url -eq $ParentFolderURL.substring(1)}
    if(!($currFolder.Folders | ? {$_.name -eq $folder.Name}))
    {
        $tmpFolder = $destinationList.Folders.Add(("$targetSiteCollection" + $ParentFolderURL), [Microsoft.SharePoint.SPFileSystemObjectType]::Folder, $folder.name)
        $tmpFolder.update()
    }
    else
    {
        $tmpFolder = $destinationList.Folders | ? {$_.name -eq $folder.Name}
    }
    
    $allFiles = $sourceList.Items
    $sourceItems = $folder.folder.Files
    
    if($folder.Folder.Files.count -gt 0)
    {
        foreach($item in $sourceItems)
        {
            $Relative = ($Item.ServerRelativeUrl).substring(1)
            $TargetItem = $allFiles | ? {$_.URL -eq $Relative}
            $sourceStream = $TargetItem.File.OpenBinary()
            $destinationFileItem = $tmpFolder.Folder.Files.Add($TargetItem.Name, $sourceStream, $true)
            $destinationFileItem.Update()
       }
    }
}